function [ Kc ] = amm_thermo( T,P,Stoic,Stoic_gas,k_cov,omega )
% Ammonia Synthesis Microkinetic Model
%  Thermodynamic equilibrium constants
%
% Input:
%   T     Temperature
%
% Output:
%   K(i)  Equilibrium constant for reaction i
%
R_e = 1.987e-3;            % Gas constant, (kcal/mol K)
% N2s
global abyv
T_h = 1000;
T_c = 500;
T_l = 100;
A_N2s1_h = [-3.0400752E-01  3.8881434E-02 -1.1835291E-04  1.6526702E-07  -8.523164E-11 -1.1679541E+02  2.5541214E-01];
A_N2s1_l = [3.8387244E+00  2.9153171E-03 -2.2895723E-06  1.4204967E-09 -4.6215242E-13 -4.9807643E+02 -1.6510729E+01];
A_Ns1_h = [1.2546837E-01 -8.5348533E-03  1.2722821E-04 -3.4758745E-07  2.9435929E-10  4.5767295E+03  -2.210639E-01];
A_Ns1_l = [-7.4310864E-02  1.1355176E-02 -1.7685383E-05 1.2956667E-08 -3.6669935E-12  4.4575942E+03 -1.1751282E+00];
A_Hs1_h = [1.7228733E-01 -7.1210715E-03  6.7939745E-05 -1.3649361E-07  8.8349382E-11 -4.5259354E+03 -3.8400029E-01];
A_Hs1_l = [-1.8459024E+00  1.5494595E-02 -2.1737629E-05  1.4732678E-08 -3.9291119E-12 -4.3934117E+03   7.201482E+00];
A_NH3s1_h = [-9.5709322E-01   3.758014E-02 -1.0458057E-04  1.6909511E-07 -1.0695751E-10 -1.3231914E+04  2.1052315E+00];
A_NH3s1_l = [6.3150154E-01  1.7896902E-02 -1.9144115E-05  1.239744E-08 -3.3437496E-12 -1.3324844E+04 -3.6982524E+00];
A_NH2s1_h = [-1.4015971E-01  7.0093233E-04  1.0003579E-04 -2.7508399E-07  2.2751081E-10 -4.4919124E+03   3.838036E-01];
A_NH2s1_l = [-1.4855037E+00  2.5013112E-02 -3.4671441E-05  2.4816553E-08 -6.9763678E-12 -4.4658626E+03  4.5946194E+00];
A_NHs1_h = [2.0873236E-01 -1.1656266E-02  1.5233112E-04 -3.7869455E-07    2.99931E-10  -2.045056E+03 -4.1249028E-01];
A_NHs1_l = [-1.7065857E+00  2.2850024E-02  -3.428778E-05  2.5129227E-08 -7.1322828E-12 -2.0154967E+03  5.5378647E+00];
A_N2s2_h =[-3.0400752E-01  3.8881434E-02 -1.1835291E-04  1.6526702E-07  -8.523164E-11 -5.906677E+03  2.5541214E-01];
A_N2s2_l = [3.8387244E+00  2.9153171E-03 -2.2895723E-06 1.4204967E-09 -4.6215242E-13  -6.287958E+03 -1.6510729E+01];
A_Ns2_h = [1.2546837E-01 -8.5348533E-03  1.2722821E-04 -3.4758745E-07  2.9435929E-10 6.4011212E+03  -2.210639E-01];
A_Ns2_l = [-7.4310864E-02  1.1355176E-02 -1.7685383E-05 1.2956667E-08 -3.6669935E-12  6.2819858E+03 -1.1751282E+00];
A_Hs2_h = [1.7228733E-01 -7.1210715E-03  6.7939745E-05 -1.3649361E-07  8.8349382E-11 -4.2066446E+03 -3.8400029E-01];
A_Hs2_l = [-1.8459024E+00  1.5494595E-02 -2.1737629E-05 1.4732678E-08 -3.9291119E-12 -4.0741209E+03   7.201482E+00];
A_NH3s2_h = [-9.5709322E-01   3.758014E-02 -1.0458057E-04  1.6909511E-07 -1.0695751E-10 -1.8442808E+04  2.1052315E+00];
A_NH3s2_l = [6.3150154E-01  1.7896902E-02 -1.9144115E-05 1.239744E-08 -3.3437496E-12 -1.8535738E+04 -3.6982524E+00];
A_NH2s2_h = [-1.4015971E-01  7.0093233E-04  1.0003579E-04 -2.7508399E-07  2.2751081E-10 -1.2247459E+04   3.838036E-01];
A_NH2s2_l = [-1.4855037E+00  2.5013112E-02 -3.4671441E-05 2.4816553E-08 -6.9763678E-12 -1.2221409E+04  4.5946194E+00];
A_NHs2_h = [2.0873236E-01 -1.1656266E-02  1.5233112E-04 -3.7869455E-07    2.99931E-10 -4.3233743E+03 -4.1249028E-01];
A_NHs2_l = [-1.7065857E+00  2.2850024E-02  -3.428778E-05 2.5129227E-08 -7.1322828E-12 -4.2938151E+03  5.5378647E+00];
A_N2_h = [3.51E+00      -1.02E-04       6.67E-07      -2.04E-09       3.11E-12   -1.04E+03       3.12E+00];
A_N2_l = [3.67E+00      -1.54E-03       3.74E-06      -2.5E-09       5.64E-13      -1.05E+03       2.47E+00];
A_H2_h = [3.24E+00       5.21E-03      -3.32E-05       8.24E-08      -6.93E-11      -1.03E+03      -3.38E+00];
A_H2_l = [3.56E+00      -1.36E-04      -1.32E-07       5.11E-10      -1.79E-13      -1.06E+03      -4.52E+00];
A_NH3_h = [4.36E+00      -6.15E-03       2.95E-05      -3.75E-08       1.74E-11  -6.74E+03      -8.04E-01];
A_NH3_l = [2.88E+00        4.6E-03      -1.61E-07   -7.1E-10       1.99E-13      -6.58E+03       5.47E+00];
A_v_h = [0 0 0 0 0 0 0];
A_v_l = [0 0 0 0 0 0 0];
%A_h = [A_N2s1_h;A_Ns1_h;A_Hs1_h;A_NH3s1_h;A_NH2s1_h;A_NHs1_h;A_N2_h;A_H2_h;A_NH3_h;A_v_h];
%A_l = [A_N2s1_l;A_Ns1_l;A_Hs1_l;A_NH3s1_l;A_NH2s1_l;A_NHs1_l;A_N2_l;A_H2_l;A_NH3_l;A_v_l];
A_h = [A_N2s2_h;A_Ns2_h;A_Hs2_h;A_NH3s2_h;A_NH2s2_h;A_NHs2_h;A_N2_h;A_H2_h;A_NH3_h;A_v_h];
A_l = [A_N2s2_l;A_Ns2_l;A_Hs2_l;A_NH3s2_l;A_NH2s2_l;A_NHs2_l;A_N2_l;A_H2_l;A_NH3_l;A_v_l];
if T>T_c
    A = A_h;
else
    A = A_l;
end
rxn = ['N2+RU(S1)<=>RU(B)+N2(S1)            ';...
       'N2(S1)+RU(S1)<=>RU(B)+2N(S1)        ';...
       'H2+2RU(S1)<=>2RU(B)+2H(S1)          ';...
       'RU(S1)+NH(S1)<=>N(S1)+H(S1)+RU(B)   ';...
       'RU(S1)+NH2(S1)<=>NH(S1)+H(S1)+RU(B) ';...
       'RU(S1)+NH3(S1)<=>NH2(S1)+H(S1)+RU(B)';...
       'NH3+RU(S1)<=>RU(B)+NH3(S1)          '];
T_H = [1 T/2 T^2/3 T^3/4 T^4/5 1/T];
T_S = [log(T) T T^2/2 T^3/3 T^4/4 1];
HORT = T_H*A(:,1:6)';
SOR  = T_S*A(:,[1:5 7])';
GORT = HORT - SOR;
Grxn = GORT * Stoic';
E = SOR - (HORT - k_cov'/(R_e*T));
E_e = E * (Stoic)';
Kp = exp(E_e)';
R = 82.057338; %(cm3 atm/K mole)
Kc = Kp .* (1/(R*T)).^(sum(Stoic_gas,2));
end

