function [ CpOR,HORT,SOR,GORT ] = amm_thermo( T,A6_LSR,A6_Cov,A6_Strain)
%%          -------------------------------------------------
%                        NH3  Micro-kinetic model
%                         Vlachos Research Group
%                 Chemical and Biomolecular Egineering
%                         University of Delaware
%
%             Gerhard R Wittreich, P.E.  (February 10, 2017)
%           --------------------------------------------------
%
%      amm_thermo.m   : NASA polynomials provides enthalpy and entropy
%
%      requires: 
%                amm_kinetics.m : Provides forward and reverse rate constants
%
% Input:
%   T     Temperature
%   A6_LSR  LSR correction to NASA polynomial A6 coefficient
%   A6_COV  Coverage correction to NASA polynomial A6 coefficient
%
% Output:
%   HORT   Dimmensionless enthalpy
%   SOR    Dimmensionless entropy
%   GORT   Dimmensionless Gibb's free energy
%
global R_e STYPE_TERRACE
T_h = 1000;
T_c = 500;
T_l = 100;
SA = 1/R_e;

A_N2s1_h  = [-3.0389116E-01  3.8896493E-02 -1.1844826E-04  1.6547503E-07 -8.5383479E-11  1.0461048E+03  2.5490376E-01];
A_N2s1_l  = [ 3.8398741E+00  2.9098818E-03 -2.2772005E-06  1.4089311E-09 -4.5833977E-13  6.6483854E+02 -1.6514162E+01];
A_Ns1_h   = [ 1.2514381E-01 -8.5266996E-03  1.2722803E-04 -3.4767398E-07  2.9447935E-10  5.235518E+03  -2.2025331E-01];
A_Ns1_l   = [-7.2361056E-02  1.1348615E-02 -1.7675847E-05  1.295004E-08  -3.6651938E-12  5.116171E+03  -1.1837901E+00];
A_Hs1_h   = [ 1.7236866E-01 -7.1264531E-03  6.8017397E-05 -1.3672807E-07  8.8559845E-11 -3.951192E+03  -3.8414481E-01];
A_Hs1_l   = [-1.8446364E+00  1.5493801E-02 -2.1740082E-05  1.4736242E-08 -3.9304652E-12 -3.8188916E+03  7.1950875E+00];
A_NH3s1_h = [-9.5737439E-01  3.7602784E-02 -1.0471454E-04  1.6942942E-07 -1.0724577E-10 -1.1179731E+04  2.1056445E+00];
A_NH3s1_l = [ 6.3192371E-01  1.790207E-02  -1.9154844E-05  1.2407789E-08 -3.3474652E-12 -1.127268E+04  -3.6998252E+00];
A_NH2s1_h = [-1.404812E-01   7.1196379E-04  1.0002678E-04 -2.7513268E-07  2.2758041E-10 -2.900248E+03   3.8453604E-01];
A_NH2s1_l = [-1.4829962E+00  2.5009061E-02 -3.4668961E-05  2.4817851E-08 -6.977616E-12  -2.8745444E+03  4.5828996E+00];
A_NHs1_h  = [ 2.0851944E-01 -1.165314E-02   1.5238542E-04 -3.7892674E-07  3.0017096E-10 -9.2372535E+02 -4.1192144E-01];
A_NHs1_l  = [-1.7035332E+00  2.2841855E-02 -3.4278156E-05  2.5124571E-08 -7.1316136E-12 -8.9458508E+02  5.5236303E+00];
A_N2s2_h  = [-3.0389116E-01  3.8896493E-02 -1.1844826E-04  1.6547503E-07 -8.5383479E-11 -4.7563787E+03  2.5490376E-01];
A_N2s2_l  = [ 3.8398741E+00  2.9098818E-03 -2.2772005E-06  1.4089311E-09 -4.5833977E-13 -5.1376449E+03 -1.6514162E+01];
A_Ns2_h   = [ 1.2514381E-01 -8.5266996E-03  1.2722803E-04 -3.4767398E-07  2.9447935E-10  3.2857192E+03 -2.2025331E-01];
A_Ns2_l   = [-7.2361056E-02  1.1348615E-02 -1.7675847E-05  1.295004E-08  -3.6651938E-12  3.1663722E+03 -1.1837901E+00];
A_Hs2_h   = [ 1.7236866E-01 -7.1264531E-03  6.8017397E-05 -1.3672807E-07  8.8559845E-11 -4.2823099E+03 -3.8414481E-01];
A_Hs2_l   = [-1.8446364E+00  1.5493801E-02 -2.1740082E-05  1.4736242E-08 -3.9304652E-12 -4.1500095E+03  7.1950875E+00];
A_NH3s2_h = [-9.5737439E-01  3.7602784E-02 -1.0471454E-04  1.6942942E-07 -1.0724577E-10 -1.6401966E+04  2.1056445E+00];
A_NH3s2_l = [ 6.3192371E-01  1.790207E-02  -1.9154844E-05  1.2407789E-08 -3.3474652E-12 -1.6494915E+04 -3.6998252E+00];
A_NH2s2_h = [-1.404812E-01   7.1196379E-04  1.0002678E-04 -2.7513268E-07  2.2758041E-10 -1.1983014E+04  3.8453604E-01];
A_NH2s2_l = [-1.4829962E+00  2.5009061E-02 -3.4668961E-05  2.4817851E-08 -6.977616E-12  -1.195731E+04   4.5828996E+00];
A_NHs2_h  = [ 2.0851944E-01 -1.165314E-02   1.5238542E-04 -3.7892674E-07  3.0017096E-10 -5.6135514E+03 -4.1192144E-01];
A_NHs2_l  = [-1.7035332E+00  2.2841855E-02 -3.4278156E-05  2.5124571E-08 -7.1316136E-12 -5.5844111E+03  5.5236303E+00];
A_N2_h    = [ 3.51E+00      -1.02E-04       6.67E-07      -2.04E-09       3.11E-12      -3.5099492E+00  3.12E+00     ];
A_N2_l    = [ 3.67E+00      -1.54E-03       3.74E-06      -2.5E-09        5.64E-13      -8.7016159E+00  2.47E+00     ];
A_H2_h    = [ 3.24E+00       5.21E-03      -3.32E-05       8.24E-08      -6.93E-11      -3.2425939E+00 -3.38E+00     ];
A_H2_l    = [ 3.56E+00      -1.36E-04      -1.32E-07       5.11E-10      -1.79E-13      -2.5316552E+01 -4.52E+00     ];
A_NH3_h   = [ 4.36E+00      -6.15E-03       2.95E-05      -3.75E-08       1.74E-11      -4.9944927E+03 -8.04E-01     ];
A_NH3_l   = [ 2.88E+00       4.6E-03       -1.61E-07      -7.1E-10        1.99E-13      -4.8297052E+03  5.47E+00     ];
A_v_h = [0 0 0 0 0 0 0];
A_v_l = [0 0 0 0 0 0 0];
if STYPE_TERRACE
    A_h = [A_N2s1_h;A_Ns1_h;A_Hs1_h;A_NH3s1_h;A_NH2s1_h;A_NHs1_h;A_N2_h;A_H2_h;A_NH3_h;A_v_h];
    A_l = [A_N2s1_l;A_Ns1_l;A_Hs1_l;A_NH3s1_l;A_NH2s1_l;A_NHs1_l;A_N2_l;A_H2_l;A_NH3_l;A_v_l];
else
    A_h = [A_N2s2_h;A_Ns2_h;A_Hs2_h;A_NH3s2_h;A_NH2s2_h;A_NHs2_h;A_N2_h;A_H2_h;A_NH3_h;A_v_h];
    A_l = [A_N2s2_l;A_Ns2_l;A_Hs2_l;A_NH3s2_l;A_NH2s2_l;A_NHs2_l;A_N2_l;A_H2_l;A_NH3_l;A_v_l];
end
if T>T_c
    A = A_h;
else
    A = A_l;
end
A6_Correction = A6_LSR + A6_Cov - A6_Strain;
if STYPE_TERRACE
    A(:,6) =  A(:,6) - [A6_Correction(1:6);0;0;0;0];
else
    A(:,6) =  A(:,6) - [A6_Correction(7:12);0;0;0;0];
end
T_Cp = [1 T T^2 T^3 T^4];
T_H  = [1 T/2 T^2/3 T^3/4 T^4/5 1/T];
T_S  = [log(T) T T^2/2 T^3/3 T^4/4 1];
CpOR = T_Cp*A(:,1:5)';
HORT = T_H*A(:,1:6)';
SOR  = T_S*A(:,[1:5 7])';
GORT = HORT - SOR;
end

